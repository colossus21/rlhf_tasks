<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wild Tic-Tac-Toe (9x9)</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        .game-container {
            text-align: center;
        }
        .game-info {
            display: flex;
            justify-content: space-between;
            width: 490px; /* Match the game board width */
            margin-bottom: 10px;
        }
        .turn-info {
            font-weight: bold;
            color: #333;
        }
        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 160px);
            grid-gap: 10px;
            background-color: #000;
            padding: 10px;
            position: relative;
        }
        .sub-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-gap: 2px;
            background-color: #000;
        }
        .cell {
            width: 50px;
            height: 50px;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
        }
        .win-line {
            position: absolute;
            background-color: #ff0000;
            z-index: 10;
        }
        .huge-symbol {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 100px;
            font-weight: bold;
            background-color: rgba(255, 255, 255, 0.8);
            z-index: 20;
        }
        .X { color: red; }
        .O { color: blue; }
        .win-line.X, .win-line.O { height: 4px; }
        .main-win-line {
            height: 10px !important;
            z-index: 30;
        }
        #winMessage {
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
            color: green;
        }
        #restartButton {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }
    </style>
</head>
<body>
<div class="game-container">
    <div class="game-info">
        <button id="restartButton" onclick="restartGame()">Restart Game</button>
        <div id="turnInfo" class="turn-info">Player O, your turn!</div>
    </div>
    <div class="game-board" id="gameBoard"></div>
    <div id="winMessage"></div>
</div>

<script>
    const gameBoard = document.getElementById('gameBoard');
    const turnInfo = document.getElementById('turnInfo');
    const winMessage = document.getElementById('winMessage');
    const restartButton = document.getElementById('restartButton');
    let currentPlayer = 'O';
    let gameActive = true;
    const subGridWins = new Array(9).fill(null);

    // Function to create the game grid
    function createGameGrid() {
        for (let i = 0; i < 9; i++) {
            const subGrid = document.createElement('div');
            subGrid.classList.add('sub-grid');
            subGrid.dataset.index = i;
            for (let j = 0; j < 9; j++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.dataset.row = Math.floor(j / 3);
                cell.dataset.col = j % 3;
                cell.addEventListener('click', handleCellClick);
                subGrid.appendChild(cell);
            }
            gameBoard.appendChild(subGrid);
        }
    }

    // Function to handle cell clicks
    function handleCellClick(event) {
        if (!gameActive) return;
        const cell = event.target;
        const subGrid = cell.parentElement;
        if (cell.textContent === '' && !subGridWins[subGrid.dataset.index]) {
            cell.textContent = currentPlayer;
            cell.classList.add(currentPlayer);
            if (checkSubGridWin(subGrid)) {
                subGridWins[subGrid.dataset.index] = currentPlayer;
                replaceSubGridWithSymbol(subGrid, currentPlayer);
                if (checkMainGridWin()) {
                    endGame(`Player ${currentPlayer} wins the game!`);
                }
            }
            currentPlayer = currentPlayer === 'O' ? 'X' : 'O';
            updateTurnInfo();
        }
    }

    // Functions for checking wins, drawing lines, replacing grids with symbols, etc.
    // These functions remain largely unchanged from your previous version but ensure they handle the new UI elements

    function checkSubGridWin(subGrid) {
        // Check win logic here
    }

    function drawWinLine(subGrid, line, isMainGrid = false) {
        const winLine = document.createElement('div');
        winLine.classList.add('win-line', currentPlayer);
        if (isMainGrid) winLine.classList.add('main-win-line');

        // Calculate line position and angle here
        // This should be adjusted to fit within the game board for main grid wins
        const rect = subGrid.getBoundingClientRect();
        winLine.style.top = `${rect.top}px`;
        winLine.style.left = `${rect.left}px`;
        winLine.style.width = `${isMainGrid ? 490 : 158}px`; // Adjust for main grid
        gameBoard.appendChild(winLine);
    }

    function replaceSubGridWithSymbol(subGrid, symbol) {
        // Replace subgrid with large symbol
    }

    function checkMainGridWin() {
        // Check for main grid win
    }

    function endGame(message) {
        gameActive = false;
        winMessage.textContent = message;
        restartButton.style.display = 'block';
    }

    function updateTurnInfo() {
        turnInfo.textContent = `Player ${currentPlayer}, your turn!`;
    }

    function restartGame() {
        // Reset game state
        gameBoard.innerHTML = '';
        currentPlayer = 'O';
        gameActive = true;
        subGridWins.fill(null);
        winMessage.textContent = '';
        createGameGrid();
        updateTurnInfo();
        restartButton.style.display = 'none';
    }

    // Initialize the game
    createGameGrid();
    updateTurnInfo();
    restartButton.style.display = 'none';
</script>
</body>
</html>