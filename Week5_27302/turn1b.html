<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rainbow Capture</title>
    <style>
        body { margin: 0; padding: 0; background: #000; }
        #gameCanvas { display: block; margin: auto; }
        .score { position: absolute; top: 10px; font-size: 24px; color: white; }
        #player1Score { left: 10px; }
        #player2Score { right: 10px; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
</head>
<body>

<div id="player1Score" class="score">VIBGYOR</div>
<div id="player2Score" class="score">VIBGYOR</div>
<div id="gameCanvas"></div>

<script type="text/javascript">
    const config = {
        type: Phaser.AUTO,
        width: 800,
        height: 600,
        scene: {
            preload: preload,
            create: create,
            update: update
        },
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 0 },
                debug: false
            }
        }
    };

    const game = new Phaser.Game(config);
    let player1, player2;
    let cursors1, cursors2;
    let circles;
    let player1Colors = new Set(), player2Colors = new Set();

    function preload() {
        // Preload is not necessary for this game since we're not using external assets
    }

    function create() {
        // Players
        player1 = this.physics.add.sprite(200, 500, 'player').setTint(0xff0000); // Red for player 1
        player2 = this.physics.add.sprite(600, 500, 'player').setTint(0x0000ff); // Blue for player 2

        // Controls
        cursors1 = this.input.keyboard.addKeys({ 'up': Phaser.Input.Keyboard.KeyCodes.W, 'left': Phaser.Input.Keyboard.KeyCodes.A, 'right': Phaser.Input.Keyboard.KeyCodes.D });
        cursors2 = this.input.keyboard.addKeys({ 'up': Phaser.Input.Keyboard.KeyCodes.I, 'left': Phaser.Input.Keyboard.KeyCodes.J, 'right': Phaser.Input.Keyboard.KeyCodes.L });

        // Circles group
        circles = this.physics.add.group();

        // Spawn circles
        this.time.addEvent({
            delay: 1000,
            callback: spawnCircle,
            callbackScope: this,
            loop: true
        });

        // Collision detection
        this.physics.add.overlap(player1, circles, collectCircle, null, this);
        this.physics.add.overlap(player2, circles, collectCircle, null, this);
    }

    function update() {
        // Player movement
        player1.setVelocity(0);
        player2.setVelocity(0);

        if (cursors1.left.isDown) player1.setVelocityX(-160);
        else if (cursors1.right.isDown) player1.setVelocityX(160);

        if (cursors1.up.isDown) player1.setVelocityY(-160);

        if (cursors2.left.isDown) player2.setVelocityX(-160);
        else if (cursors2.right.isDown) player2.setVelocityX(160);

        if (cursors2.up.isDown) player2.setVelocityY(-160);

        // Check win condition
        checkWin(player1Colors, 'player1Score');
        checkWin(player2Colors, 'player2Score');
    }

    function spawnCircle() {
        const x = Phaser.Math.Between(50, 750);
        const color = ['#9400D3', '#4B0082', '#0000FF', '#00FF00', '#FFFF00', '#FF7F00', '#FF0000'][Phaser.Math.Between(0, 6)];
        let circle = circles.create(x, 0, 'circle').setTint(color).setScale(0.5);
        circle.setVelocityY(Phaser.Math.Between(50, 150));
    }

    function collectCircle(player, circle) {
        const color = Phaser.Display.Color.ColorToRGBA(circle.tintTopLeft);
        if (player === player1) player1Colors.add(color);
        else player2Colors.add(color);
        circle.destroy();
    }

    function checkWin(colors, playerId) {
        if (colors.size === 7) {
            alert('Player at ' + playerId + ' wins!');
            game.scene.restart();
        }
        updateScoreDisplay(colors, playerId);
    }

    function updateScoreDisplay(colors, playerId) {
        const letters = document.getElementById(playerId).children;
        let index = 0;
        for (let color of ['#9400D3', '#4B0082', '#0000FF', '#00FF00', '#FFFF00', '#FF7F00', '#FF0000']) {
            if (colors.has(color)) {
                letters[index].style.color = color;
            }
            index++;
        }
    }
</script>

</body>
</html>