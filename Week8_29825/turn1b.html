<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shape Chasers</title>
    <style>
        body { font-family: Arial, sans-serif; display: flex; flex-direction: column; align-items: center; background-color: #f0f0f0; }
        #gameBoard { display: grid; grid-template-columns: repeat(9, 40px); grid-gap: 2px; margin: 20px 0; }
        .cell { width: 40px; height: 40px; border: 1px solid #ccc; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .player1 { background-color: red; color: white; }
        .player2 { background-color: blue; color: white; }
        #status, #shuffleTimer { margin: 10px 0; }
        #gameOver { display: none; margin-top: 20px; text-align: center; }
        button { padding: 10px; margin-top: 10px; cursor: pointer; }
    </style>
</head>
<body>

<h1>Shape Chasers</h1>
<div id="status">
    <span style="color: red;">P1: </span><span id="p1Collection"></span> |
    <span style="color: blue;">P2: </span><span id="p2Collection"></span>
</div>
<div id="gameBoard"></div>
<div id="shuffleTimer">Next Shuffle in: 10 turns</div>
<div id="gameOver">
    <h2 id="winnerMessage"></h2>
    <button onclick="restartGame()">Restart Game</button>
</div>

<script>
    const board = document.getElementById('gameBoard');
    const status = document.getElementById('status');
    const shuffleTimerDisplay = document.getElementById('shuffleTimer');
    const gameOverDiv = document.getElementById('gameOver');
    const winnerMessage = document.getElementById('winnerMessage');

    let gameState = {
        board: Array(9).fill().map(() => Array(9).fill(null)),
        player1: {x: 0, y: 0, collection: [], goal: []},
        player2: {x: 8, y: 8, collection: [], goal: []},
        shapes: ['ðŸ', 'ðŸŽ', 'ðŸ', 'ðŸŠ', 'ðŸ‹', 'ðŸŒ', 'ðŸ‰', 'ðŸ‡', 'ðŸ“', 'ðŸˆ', 'ðŸ’', 'ðŸ‘'],
        turn: 1,
        moveCount: 0
    };

    function initGame() {
        gameState.goal = gameState.shapes.sort(() => 0.5 - Math.random()).slice(0, 5);
        placeShapes();
        updateBoard();
        document.addEventListener('keydown', movePlayer);
    }

    function placeShapes() {
        const availableCells = [];
        for(let i = 0; i < 9; i++) {
            for(let j = 0; j < 9; j++) {
                if((i !== 0 || j !== 0) && (i !== 8 || j !== 8)) availableCells.push([i, j]);
            }
        }
        availableCells.sort(() => 0.5 - Math.random());
        for(let i = 0; i < 12; i++) {
            const [x, y] = availableCells[i];
            gameState.board[x][y] = gameState.shapes[i % gameState.shapes.length];
        }
    }

    function updateBoard() {
        board.innerHTML = '';
        for(let y = 0; y < 9; y++) {
            for(let x = 0; x < 9; x++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                if(x === gameState.player1.x && y === gameState.player1.y) {
                    cell.classList.add('player1');
                    cell.textContent = '1';
                } else if(x === gameState.player2.x && y === gameState.player2.y) {
                    cell.classList.add('player2');
                    cell.textContent = '2';
                } else if(gameState.board[x][y]) {
                    cell.textContent = gameState.board[x][y];
                }
                board.appendChild(cell);
            }
        }
        updateStatus();
    }

    function movePlayer(e) {
        let player = gameState.turn % 2 === 1 ? gameState.player1 : gameState.player2;
        let moveX = 0, moveY = 0;
        switch(e.key) {
            case 'ArrowUp': case 'w': moveY = -1; break;
            case 'ArrowDown': case 's': moveY = 1; break;
            case 'ArrowLeft': case 'a': moveX = -1; break;
            case 'ArrowRight': case 'd': moveX = 1; break;
        }
        const newX = Math.max(0, Math.min(8, player.x + moveX));
        const newY = Math.max(0, Math.min(8, player.y + moveY));

        if(newX !== player.x || newY !== player.y) {
            gameState.moveCount++;
            if(gameState.board[newX][newY]) {
                if(gameState.board[newX][newY] === gameState.goal[player.collection.length]) {
                    player.collection.push(gameState.board[newX][newY]);
                } else {
                    player.collection = [];
                }
                gameState.board[newX][newY] = null;
            }
            player.x = newX; player.y = newY;
            gameState.turn++;
            checkShuffle();
            checkWin(player);
            updateBoard();
        }
    }

    function updateStatus() {
        document.getElementById('p1Collection').textContent = gameState.player1.collection.join('');
        document.getElementById('p2Collection').textContent = gameState.player2.collection.join('');
        shuffleTimerDisplay.textContent = `Next Shuffle in: ${10 - (gameState.moveCount % 10)} turns`;
    }

    function checkShuffle() {
        if(gameState.moveCount % 10 === 0) {
            placeShapes();
        }
    }

    function checkWin(player) {
        if(player.collection.length === 5) {
            document.removeEventListener('keydown', movePlayer);
            gameOverDiv.style.display = 'block';
            winnerMessage.textContent = `Player ${player === gameState.player1 ? '1 (Red)' : '2 (Blue)'} Wins!`;
        }
    }

    function restartGame() {
        gameState = {
            ...gameState,
            player1: {x: 0, y: 0, collection: [], goal: []},
            player2: {x: 8, y: 8, collection: [], goal: []},
            turn: 1,
            moveCount: 0
        };
        initGame();
        gameOverDiv.style.display = 'none';
    }

    initGame();
</script>
</body>
</html>