<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f7fafc;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 50%;
        }
    </style>
</head>
<body class="bg-gray-100">
<div class="container mx-auto p-4 pt-6 md:p-6 lg:p-12">
    <button onclick="document.getElementById('eventModal').style.display='block'" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
        Add Event
    </button>
    <div class="events-container shadow-md rounded p-4 bg-white mt-4">
        <div id="events-list">
            <!-- Events will be listed here -->
        </div>
        <div id="show-hide-all" class="text-center mt-4">
            <button onclick="showAllEvents()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded text-sm">
                Show All
            </button>
            <button onclick="hideEvents()" class="bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-3 rounded text-sm">
                Hide
            </button>
        </div>
    </div>
</div>

<!-- Modal -->
<div id="eventModal" class="modal">
    <div class="modal-content">
        <span onclick="document.getElementById('eventModal').style.display='none'" class="close float-right text-lg cursor-pointer">&times;</span>
        <form id="addEventForm">
            <label for="eventName" class="block text-sm font-medium text-gray-700">Event Name:</label>
            <input type="text" id="eventName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm">
            <label for="eventDate" class="block text-sm font-medium text-gray-700 mt-2">Date:</label>
            <input type="date" id="eventDate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm">
            <label for="eventType" class="block text-sm font-medium text-gray-700 mt-2">Event Type:</label>
            <select id="eventType" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm">
                <option value="birthday">Birthday</option>
                <option value="anniversary">Anniversary</option>
            </select>
            <button onclick="addEvent()" type="button" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded mt-4">Add Event</button>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/min/moment.min.js"></script>
<script>
    let events = [];

    function setup() {
        noCanvas();
        displayEvents(events);
    }

    function displayEvents(eventList) {
        const eventsListElement = document.getElementById('events-list');
        eventsListElement.innerHTML = ''; // Clear the list

        if (eventList.length === 0) {
            eventsListElement.innerHTML = '<p class="text-center">No upcoming events</p>';
            return;
        }

        eventList.forEach((event, index) => {
            const eventDate = moment(event.date);
            const thisYear = moment().year();
            const eventThisYear = eventDate.clone().year(thisYear);
            if (eventThisYear.isBefore(moment())) {
                eventThisYear.add(1, 'years');
            }
            const daysToGo = eventThisYear.diff(moment(), 'days');
            const eventHtml = `
                    <div class="flex justify-between mb-2">
                        <img src="${event.type === 'birthday' ? 'birthday.png' : 'anniversary.png'}" class="w-6 h-6 mr-2" alt="${event.type}">
                        <div class="flex-grow">${event.name}</div>
                        <div>${formatCountdown(daysToGo)}</div>
                    </div>
                `;
            eventsListElement.innerHTML += eventHtml;
        });

        const showHideAllElement = document.getElementById('show-hide-all');
        if (events.length > 3) {
            showHideAllElement.style.display = 'block';
        } else {
            showHideAllElement.style.display = 'none';
        }
    }

    function formatCountdown(days) {
        if (days === 0) return 'Today';
        if (days === 1) return 'Tomorrow';
        return `${days} days to go`;
    }

    function showAllEvents() {
        displayEvents(events);
    }

    function hideEvents() {
        displayEvents(events.slice(0, 3));
    }

    function addEvent() {
        const eventName = document.getElementById('eventName').value;
        const eventDate = document.getElementById('eventDate').value;
        const eventType = document.getElementById('eventType').value;
        const newEvent = {type: eventType, name: eventName, date: eventDate};
        events.push(newEvent);
        document.getElementById('eventModal').style.display='none';
        document.getElementById('addEventForm').reset();
        displayEvents(events);
    }
</script>
</body>
</html>