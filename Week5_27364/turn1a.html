<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Side Scroller Game</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        #game-container {
            position: relative;
            overflow: hidden;
        }
        #canvas {
            border: 1px solid black;
            display: block;
        }
        .info {
            position: absolute;
            top: 10px;
            font-family: Arial, sans-serif;
            font-size: 18px;
            text-align: center;
            width: 100%;
            color: white;
            text-shadow: 2px 2px 4px #000000;
        }
        .distance {
            right: 20px;
            top: 10px;
            position: absolute;
        }
        .timer {
            left: 50%;
            transform: translateX(-50%);
        }
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 36px;
            color: white;
            text-shadow: 2px 2px 4px #000000;
            display: none;
        }
        .restart-button {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
            cursor: pointer;
            display: none;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.18.0/matter.min.js"></script>
</head>
<body>
<div id="game-container">
    <canvas id="canvas" width="800" height="200"></canvas>
    <div class="info timer">Time: 60</div>
    <div class="info distance">Distance: 0m</div>
    <div class="game-over">Game Over!</div>
    <button class="restart-button">Restart</button>
</div>
<script>
    const { Engine, Render, Runner, Bodies, Composite, Events } = Matter;

    const engine = Engine.create();
    const render = Render.create({
        canvas: document.getElementById('canvas'),
        engine: engine,
        options: {
            wireframes: false,
            showSleeping: true,
            background: 'transparent'
        }
    });

    const ground = Bodies.rectangle(400, 210, 810, 20, { isStatic: true });
    const player = Bodies.polygon(50, 100, 3, 20, { friction: 0.05, restitution: 0.2 });
    const finishLine = Bodies.rectangle(850, 100, 10, 200, { isStatic: true });

    const randomColor = () => `#${Math.floor(Math.random()*16777215).toString(16)}50`;

    let obstacles = [];
    for (let i = 0; i < 10; i++) {
        let obstacle = Bodies.rectangle(150 + i * 70, 150, 20, 20, {
            isStatic: true,
            render: { fillStyle: randomColor() }
        });
        obstacles.push(obstacle);
    }

    Composite.add(engine.world, [ground, player, finishLine, ...obstacles]);

    Render.run(render);
    const runner = Runner.create();
    Runner.run(runner, engine);

    let timeLeft = 60;
    let distance = 0;
    const timerInterval = setInterval(() => {
        timeLeft -= 1;
        document.querySelector('.timer').textContent = `Time: ${timeLeft}`;
        if (timeLeft <= 0) {
            endGame(false);
        }
    }, 1000);

    Events.on(runner, 'beforeUpdate', function() {
        Matter.Body.setVelocity(player, { x: 3, y: player.velocity.y });
        distance = Math.floor((player.position.x - 50) / 10);
        document.querySelector('.distance').textContent = `Distance: ${distance}m`;
        if (player.position.x > 800) {
            endGame(true);
        }
    });

    document.addEventListener('keydown', event => {
        if (event.key === 'w' || event.key === 'W') {
            Matter.Body.setVelocity(player, { x: player.velocity.x, y: -5 });
        }
    });

    function endGame(won) {
        clearInterval(timerInterval);
        document.querySelector('.game-over').style.display = 'block';
        document.querySelector('.restart-button').style.display = 'block';
        document.querySelector('.game-over').textContent = won ? 'You Win!' : 'You Lose!';
    }

    document.querySelector('.restart-button').addEventListener('click', () => {
        location.reload();
    });

    // Dynamic background
    for (let i = 0; i < 50; i++) {
        const shape = Bodies.polygon(Math.random() * 800, Math.random() * 200, Math.floor(Math.random() * 6) + 3, Math.random() * 50, {
            isStatic: true,
            render: { fillStyle: randomColor() }
        });
        Composite.add(engine.world, shape);
    }
</script>
</body>
</html>