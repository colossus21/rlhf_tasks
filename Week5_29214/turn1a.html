<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mystery Detective</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        #gameBoard {
            width: 400px;
            height: 400px;
            position: relative;
            margin: 20px auto;
            border: 2px solid #000;
        }
        .player {
            position: absolute;
            text-align: center;
            width: 100px;
        }
        .player.human { bottom: 0; left: 150px; }
        .player.cpu1 { left: 0; top: 150px; }
        .player.cpu2 { right: 0; top: 150px; }
        .player.cpu3 { top: 0; left: 150px; }
        .card {
            width: 50px;
            height: 70px;
            background: #ddd;
            margin: 10px auto;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #centerCards {
            position: absolute;
            top: 150px;
            left: 150px;
            display: flex;
        }
        #feedback, #turnIndicator {
            text-align: center;
            margin-top: 10px;
        }
    </style>
</head>
<body>

<div id="gameBoard">
    <div id="centerCards"></div>
    <div class="player human"><div class="card">You</div></div>
    <div class="player cpu1"><div class="card">Sleuth 1</div></div>
    <div class="player cpu2"><div class="card">Sleuth 2</div></div>
    <div class="player cpu3"><div class="card">Sleuth 3</div></div>
</div>
<div id="turnIndicator"></div>
<div id="feedback"></div>

<script>
    let cards = ['Detective', 'Thief', 'Mob', 'Serial Killer'];
    let points = { 'human': 0, 'cpu1': 0, 'cpu2': 0, 'cpu3': 0 };
    let currentTarget = 0; // 0: Thief, 1: Mob, 2: Serial Killer
    let cardLocations = shuffle([...cards]);

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function displayCards() {
        $('#centerCards').html(cardLocations.map((card, index) =>
            `<div class="card" data-index="${index}">${card === 'Detective' ? card : '?'}</div>`
        ).join(''));
    }

    function updateFeedback(message) {
        $('#feedback').text(message);
    }

    function updateTurnIndicator() {
        const targets = ['Thief', 'Mob', 'Serial Killer'];
        $('#turnIndicator').text(`Find the ${targets[currentTarget]}`);
    }

    function cpuGuess() {
        setTimeout(() => {
            let guess = Math.floor(Math.random() * 4);
            while (cardLocations[guess] === 'Detective') {
                guess = Math.floor(Math.random() * 4);
            }
            checkGuess(guess, 'cpu');
        }, 3000);
    }

    function checkGuess(index, player) {
        let feedback = '';
        if (cardLocations[index] === cards[currentTarget + 1]) {
            feedback = `${player === 'human' ? 'You' : 'Sleuth ' + player.slice(-1)} found the ${cards[currentTarget + 1]}!`;
            for (let p in points) {
                if (p !== player) points[p] += cards[currentTarget + 1] === 'Detective' ? 1000 : (cards[currentTarget + 1] === 'Thief' ? 600 : 800);
            }
        } else {
            feedback = `${player === 'human' ? 'You' : 'Sleuth ' + player.slice(-1)} missed!`;
            for (let p in points) {
                if (p !== 'detective') points[p] += 1000;
            }
        }
        updateFeedback(feedback);
        currentTarget = (currentTarget + 1) % 3;
        updateTurnIndicator();
        if (player === 'human') setTimeout(nextTurn, 2000);
    }

    function nextTurn() {
        if (Math.max(...Object.values(points)) >= 4000) {
            alert('Game Over! ' + Object.keys(points).find(key => points[key] === Math.max(...Object.values(points))) + ' wins!');
            return;
        }
        // Reset for next turn or AI's turn
        displayCards();
        if (cardLocations[0] === 'Detective') {
            cpuGuess(); // Assuming CPU always at index 0 for simplicity
        }
    }

    $(document).on('click', '.card', function() {
        if (cardLocations[0] !== 'Detective') return; // Human player's turn check
        let index = $(this).data('index');
        checkGuess(index, 'human');
    });

    // Initialize Game
    displayCards();
    updateTurnIndicator();
    nextTurn();
</script>

</body>
</html>